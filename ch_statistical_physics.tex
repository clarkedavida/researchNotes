\chapter{Physics: Statistical Physics}

One regime of interest for lattice QCD calculations is the application
of lattice formalism to hot, dense nuclear systems; this is the realm
of thermodynamics\index{thermodynamics} and statistical physics. In this chapter I try to
offer some reminders of statistical physics, especially those that
are directly relevant to modern lattice investigations of the QCD
phase diagram. Some references I drew from include
Ref.~\cite{tahir-kheli_general_2012} and \cite{kardar_statistical_2007}.

\section{Equations of state}\label{sec:EoS}


Probably the equation of state that you are most familiar with is the 
ideal gas law,
\begin{equation}
  PV=NkT.
\end{equation}
The volume $V$ and the number of particles $N$ both scale linearly with the
size of the system; we call such variables {\it extensive}\index{extensive}. 
Meanwhile the pressure $P$ and the temperature $T$ are {\it intensive}
\index{intensive}, i.e. they do not scale with the system.

There is an equation of state for each intensive variable required for the
description of thermodynamic states. For example from the
first law of thermodynamics,
\begin{equation}\label{eq:fslaw}
  \dd{U}=T\dd{S}-P\dd{V}+\sum_i\mu_i\dd{N}_i,
\end{equation}
we know that\index{thermodynamics!first law}
\begin{equation}
  T=\pder[U]{S}.
\end{equation}
This intensive variable $T$ depends on only the extensive variables; 
generally we could write
\begin{equation}
  T=T(U,S,V,N).
\end{equation}
This is what we call an {\it equation of state}\index{equation of state}. 
Knowing every equation 
of state is enough to reconstruct the fundamental equation, and therefore 
enough to determine the physics of the system.

\section{Legendre transforms}\index{Legendre transformation}

Equation~\eqref{eq:fslaw} tells us that we can think of the internal energy
$U$ of a system in equilibrium at $(T,P,\mu)$ as a function of $S$, $V$, and
$N$. However one of these extensive variables, such as $S$, may be
difficult or impossible to measure, and therefore we would rather
think in terms of the more accessible quantity $T$, which 
is the derivative of $U$ with respect to $S$. 
Hence we want 
\begin{enumerate}
\item to look at $U$ in terms of a derivative with respect to $S$ rather 
      than $S$ itself; moreover 
\item we don't want to lose any information we had before, i.e. we want this
      process to be invertible. 
\end{enumerate}
These are the purposes of a Legendre transformation. The second point 
may seem too obvious to state, but it's worth emphasizing here because 
what makes thermodynamic potentials such as $U$ special is that you're 
supposed to be able to determine state variables like $T$ from them. 
Since no information is lost, Legendre transforms guarantee that 
thermodynamic potentials get transformed to other thermodynamic potentials.
\index{thermodynamic potential} 

Before we define a Legendre transformation, let's look at an example
due to Markus Deserno~\cite{deserno} where a naive transformation can go
wrong and information can be lost. 
\begin{example*}{}
We consider a function $y(x)$ and define a new variable
\begin{equation}\label{eq:xlegendre}
  p\equiv y'(x).
\end{equation}
In order to accomplish goal (1) above, one might naively solve
\equatref{eq:xlegendre} for $x$, obtaining the function $x(p)$
and then plug this back into $y(x)$ to obtain
\begin{equation}
  Y(p)=y\left(y'^{-1}(p)\right).
\end{equation}
To see that this procedure destroys information, consider the example
\begin{equation}\label{eq:badlegendre}
  y(x)=\frac{1}{2}(x-x_0)^2.
\end{equation}
The derivative is $p=y'(x)=x-x_0$, and hence $x=p+x_0$. Plugging this
into \equatref{eq:badlegendre} we get the function
\begin{equation}
  Y(p)=y(x(p))=\frac{1}{2}\left(x(p)-x_0\right)^2=\frac{1}{2}p^2.
\end{equation}
Evidently all functions of the form~\eqref{eq:badlegendre} get transformed
to the same function regardless of the value of $x_0$; therefore there is
no way starting from $Y(p)$ to figure out what $x_0$ was. Hence
information was destroyed.
\end{example*}

Now on to the definition. Recall that a function $f$ is {\it convex}
\index{function!convex} in a region if the graph of the function lies 
below the line segment connecting any two points in that region. It is 
{\it concave}\index{function!concave} if $-f$ is convex. Consider
a function $y:\R\to\R$. Then the 
{\it Legendre transform} is defined by
\begin{equation}
Y(p)=\begin{cases}
  \min_x [y(x)-xp] & \text{if $y$ is convex}\\
  \max_x [y(x)-xp] & \text{if $y$ is concave.}
\end{cases}
\end{equation}
This definition makes sense in view of goal (1) at the beginning of this
section, assuming $y$ is differentiable. To see this, note that the maximum
or the minimum corresponds to a critical point, and so
\begin{equation}\label{eq:legendremin}
  0=\frac{d}{dx}\left[y(x)-xp\right]=y'(x)-p.
\end{equation}

We now state two useful facts about Legendre transforms. These can
be relatively straightforwardly proven. We emphasize that Legendre
transformations are only defined for concave or convex functions, and
that the concavity or convexity is important to prove the second point,
because it guarantees that the derivative is monotonic.
\begin{proposition}{}{}
  \begin{enumerate}
    \item The Legendre transformation of a convex function is concave
          and vice versa.
    \item The Legendre transformation is its own inverse.
  \end{enumerate}
\end{proposition}

Now that we have some intuition for why one might want to do a
Legendre transform, we are going to see how some other useful
thermodynamic potentials arise from carrying them out.

\subsection{Helmholtz free energy}
\index{free energy!Helmholtz}
Let us now return to our issue of dropping $S$ in favor
of $T$. According to the above section if we
Legendre transform $U(S)$ out of the variable $S$, then the minimization
will guarantee that the new independent variable is $T$. Calling
this new function $F$, we obtain
\begin{equation}\label{eq:helmholtz}
  F(V,T,N)=U-ST.
\end{equation}
This new function is guaranteed to be a thermodynamic potential, and
we give it a special name: the {\it Helmholtz free energy}.
From \equatref{eq:helmholtz} and the first law, we get
\begin{equation}\label{eq:helmholtz1st}
  \dd F = -S\dd T-P\dd V+\sum_i\mu_i\dd{N}_i.
\end{equation}

We can derive some useful thermodynamic relations from these. For
instance\footnote{It can be quite confusing to track which variables
are held fixed and allowed to vary doing these partial derivatives.
You can get a hint for example by looking at equations like
\equatref{eq:helmholtz1st}, which is a reminder we are thinking of
$F$ as a function of the set \{$T$, $V$, $\vec{N}$\}. In this context,
partial derivatives with respect to one of those variables must
guarantee the others in the set are fixed.}
\begin{equation}\label{eq:dfdt}
  -T^2\pder[(F/T)]{T}=U=\pder[\beta F]{\beta}.
\end{equation}

%\section{Cumulants}

\section{Ideal quantum gas}

\subsection{Canonical formulation}

\index{gas!bose}\index{gas!fermi}
\begin{equation}
\eta=
  \begin{cases}
     +1 & \text{bosonic gas} \\
     -1 & \text{fermionic gas}.
  \end{cases}
\end{equation}

\subsection{Grand canonical formulation}

% keep discussion general to mu_i N_i
\index{fugacity}
\begin{equation}
  z=e^{-N\mu/T}
\end{equation}

The {\it grand potential} is\index{grand potential}
\begin{equation}
  \Phi\left(V,T,\vec{\mu}\right)=U-TS-\sum_i\mu_i N_i=-T\log\grandZ
\end{equation}
from which one gets
\begin{equation}
  \dd\Phi=-P\dd V-S\dd T-\sum_i N_i\dd\mu_i.
\end{equation}


\section{Relativistic quantum gases}

Relativistic quantum gases are especially interesting for us
to consider especially because of their
application to low temperatures of the QCD phase diagram. There, the medium
behaves approximately like a relativistic gas of hadronic bound states.
This allows for a cross check against lattice QCD at low temperatures
and at finite densities. Following some lecture notes by F. Karsch,
we are going to derive the
pressure. From this we can derive other thermodynamic quantities
using standard thermodynamic relations.

We use units $\hbar=c=k_B=1$ and consider a gas of a single species
with spin $s$ and rest mass $m$. Working in the rest frame of the gas,
we have
\begin{equation}\label{eq:dispersion}
  E=\sqrt{p^2+m^2}.  
\end{equation}
From the grand canonical formulation,
doing the momentum integral in spherical coordinates, the pressure is
\begin{equation}
  \frac{P}{T}=-\frac{4\pi\eta g}{(2\pi)^3}\int_0^\infty 
      \dd{p}p^2\log\left(1-\eta z e^{-E/T}\right),
\end{equation}
where $g=2s+1$ is the {\it degeneracy factor}. \index{degeneracy factor}
Solving the dispersion relation
for $p$ and substituting it into the pressure gives
\begin{equation}
  \frac{P}{T}=-\frac{4\pi\eta g}{(2\pi)^3}\int_m^\infty 
      \dd{E}E\left(E^2-m^2\right)^{1/2}\log\left(1-\eta z e^{-E/T}\right).
\end{equation}
Expanding the logarithm yields
\begin{equation}\label{eq:pressE}
  \frac{P}{T}=\frac{4\pi g}{(2\pi)^3}\sum_{k=1}^\infty\eta^{k+1}\frac{z^k}{k}\int_m^\infty 
      \dd{E}E\left(E^2-m^2\right)^{1/2}e^{-kE/T},
\end{equation}
which is of course only valid for $\eta z\exp(-E/T)<1$.

Let us now evaluate the integral in \equatref{eq:pressE}. We introduce
$x\equiv E/m$. Performing this variable change and integrating by parts gives
\begin{equation}\label{eq:pressint}
  \int_m^\infty\dd{E}E\left(E^2-m^2\right)^{1/2}e^{-kE/T}
  =\frac{km^4}{3T}\int_1^\infty\dd x\left(x^2-1\right)^{3/2}e^{-mkx/T}.
\end{equation}
This integral can now be expressed in terms of the
{\it modified Bessel functions}\index{Bessel function!modified}
\begin{equation}
  K_\nu(a)=\frac{\pi^{1/2}(a/2)^\nu}{\Gamma(\nu+1/2)}
             \int_1^\infty\dd x(x^2-1)^{\nu-1/2}e^{-ax}.
\end{equation}
In particular we see upon comparison with \equatref{eq:pressint}
that our integral contains $K_2(mk/T)$. Combining everything,
using $\Gamma(5/2)=3\pi^{1/2}/4$, we obtain
\begin{equation}\label{eq:pressrelQM}
  \frac{P}{T}=\frac{m^2gT}{2\pi^2}\sum_{k=1}^\infty\frac{\eta^{k+1}z^k}{k^2}
                         K_2\left(\frac{mk}{T}\right),
\end{equation}
which is a form that is well suited for computer calculations.

Other thermodynamic quantities can be derived straightforwardly
from the pressure in this form. In this context it is useful to know
the following relation for derivatives of modified Bessel functions:
\begin{equation}
  \pder[K_\nu(z)]{z}=-K_{\nu-1}(z)-\frac{\nu}{z}K_\nu(z).
\end{equation}
Using~\equatref{eq:dfdt} one then gets for the energy density
\begin{equation}\label{eq:edensityQM}
  \epsilon=\frac{m^2gT}{2\pi^2}\sum_{k=1}^\infty\frac{\eta^{k+1}z^k}{k^2}
              \left( mk K_1\left(\frac{mk}{T}\right) 
                    + 3TK_2\left(\frac{mk}{T}\right) \right).
\end{equation}

In the context of lattice calculations, which we will discuss in more
detail in \chref{ch:realPhys}, it is often more convenient to switch
from the variable $\mu$ to $\muh\equiv\mu/T$. Besides the fact that
all quantities directly going into and coming out of lattice calculations
must be unitless, this also has the advantage of making the
fugacity blind to partial derivatives w.r.t. $T$, which are then 
interpreted as being done at fixed $\muh$.

\subsection{Hadron resonance gas}\label{sec:HRG}\index{gas!hadron resonance}

Knowing the pressure \equatref{eq:pressrelQM}, we are now ready to write down
some expressions for the {\it hadron resonance gas} (HRG) model,
following Ref.~\cite{karsch_probing_2011}.

The HRG model is a low temperature model, in the sense we imagine we are working
in a phase where quarks are confined, so that the only degrees of freedom are
hadronic bound states. To a good approximation, this means we need only include
stable mesons, baryons, and their antiparticles.

\bibliographystyle{unsrtnat}
\bibliography{bibliography}
